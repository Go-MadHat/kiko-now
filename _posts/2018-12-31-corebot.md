---
layout: post
title: ! '35C3_CTF_Corebot'
excerpt_separator: <!--more-->
tags:
  - Koon
  - Write-up
  - 35C3 CTF
  - wrestool
  - PE
---

35C3 CTF에 나온 리버싱 문제 corebot에 관하여 작성합니다.

<!--more-->

## 개요

35C3 CTF에서 가장 낮은 리버싱 문제입니다. 오랜만에 보는 PE 파일을 사용하는 문제, 1~2시간 끄적이다가 풀지 못했다.

외국 애들이 쓴 Write-up이 올라오자 마자 직접 확인해보며, 공부 했습니다.

개인적인 생각으로는 파일을 암,복호화 하는 랜섬웨어의 기초를 알려주는 문제인듯 합니다.

## 도구
* wrestool = PE파일의 리소스를 추출해주는 도구


## 풀기
![]({{ site.baseurl }}/images/Koon/Corebot/corebot_1.PNG)
하나의 파일을 얻습니다.(corebot-640d3c582340e647d72e1dd9418a3fd6)

따로 접근법이 생각나지 않아, IDA를 사용하였습니다.
![]({{ site.baseurl }}/images/Koon/Corebot/corebot_2.PNG)
전체적인 흐름은 위의 사진처럼 매우 단순합니다.


IDA HEX-RAY를 통해 코드를 확인합니다.
![]({{ site.baseurl }}/images/Koon/Corebot/corebot_3.PNG)

![]({{ site.baseurl }}/images/Koon/Corebot/corebot_4.PNG)
CryptAcquireContextA -> GetVolumeInformationA -> "AES KEY GENERATE" -> CryptImportKey -> CryptSetKeyParam -> sub()(load resource)  -> CryptDecrypt -> check!



## 결론
wrestool에 대해서 알게 되었고, 개인적으로 처음 보는 유형이었다.

